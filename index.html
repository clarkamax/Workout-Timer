<!doctype html>

<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Interval Timer</title>


<style>
body{ margin:0; height:100vh; display:flex; flex-direction:column; background:#000; font-family:Arial, Helvetica, sans-serif; }
.center{ flex:1; display:grid; grid-template-rows:auto auto auto; align-content:center; justify-items:center; gap:10px; }
#phase{ font-weight:900; font-size:70px; color:#00ff5a; }
#time{ font-weight:900; font-size:22vw; color:#ff2a2a; font-variant-numeric: tabular-nums; line-height:1; }
#set{ font-weight:800; font-size:45px; color:#fff; }
.controls{ border-top:1px solid #222; padding:14px; background:#050505; display:flex; gap:12px; flex-wrap:wrap; justify-content:center; align-items:center; }
label{ color:#bbb; font-size:12px; margin-right:6px; }
input{ width:120px; padding:10px; border-radius:8px; border:1px solid #333; background:#111; color:#fff; font-size:16px; }
button{ padding:12px 16px; border-radius:8px; border:1px solid #333; background:#222; color:#fff; font-weight:900; }
button.primary{ background:#1d4ed8; border-color:#1d4ed8; }
button:disabled{ opacity:.4; }
</style>


</head>


<body>


<div class="center">
  <div id="phase">READY</div>
  <div id="time">01:00</div>
  <div id="set">SET 1 / 5</div>
</div>


<div class="controls">
  <label>Seconds</label><input id="seconds" type="number" min="1" value="60">
  <label>Sets</label><input id="sets" type="number" min="1" value="5">
  <button class="primary" id="start">START</button>
  <button id="stop" disabled>STOP</button>
  <button id="reset">RESET</button>
</div>


<script>
// ---- Custom horn only ----
const horn = new Audio('horn.wav?v=2');
horn.preload = 'auto';
horn.volume = 1.0;

async function playHorn(){
  try{ horn.currentTime = 0; await horn.play(); }catch(e){}
}

// ---- Timer logic ----
const phaseEl = document.getElementById('phase');
const timeEl  = document.getElementById('time');
const setEl   = document.getElementById('set');

const secInput = document.getElementById('seconds');
const setInput = document.getElementById('sets');

const startBtn = document.getElementById('start');
const stopBtn  = document.getElementById('stop');
const resetBtn = document.getElementById('reset');

let total = 60;
let remain = 60;
let sets = 5;
let current = 1;
let running = false;
let intervalId = null;

function fmt(s){
  const m = Math.floor(s/60);
  const r = s%60;
  return String(m).padStart(2,'0') + ':' + String(r).padStart(2,'0');
}

function readInputs(){
  total = Math.max(1, parseInt(secInput.value, 10) || 60);
  sets  = Math.max(1, parseInt(setInput.value, 10) || 5);
  if(current > sets) current = sets;
}

function render(){
  timeEl.textContent = fmt(remain);
  setEl.textContent = `SET ${current} / ${sets}`;
  if(running && remain <= 5) timeEl.style.color = '#ffb020';
  else timeEl.style.color = '#ff2a2a';
  startBtn.disabled = running;
  stopBtn.disabled = !running;
}

function start(){
  if(running) return;
  readInputs();
  if(remain <= 0) remain = total;
  running = true;
  phaseEl.textContent = 'WORK';
  playHorn();

  intervalId = setInterval(()=>{
    remain -= 1;
    if(remain <= 0){
      remain = 0;
      render();
      playHorn(); // play your custom horn at set end as well
      if(current < sets) current += 1; else current = 1;
      remain = total;
    }
    render();
  }, 1000);
  render();
}

function stop(){
  running = false;
  if(intervalId) clearInterval(intervalId);
  intervalId = null;
  phaseEl.textContent = 'PAUSED';
  render();
}

function resetAll(){
  stop();
  readInputs();
  current = 1;
  remain = total;
  phaseEl.textContent = 'READY';
  render();
}

startBtn.addEventListener('click', start);
stopBtn.addEventListener('click', stop);
resetBtn.addEventListener('click', resetAll);

window.addEventListener('keydown', (e)=>{
  if(e.code === 'Space'){ e.preventDefault(); running ? stop() : start(); }
});

render();
</script>


</body>
</html>
